<!DOCTYPE html>
<html lang="en" class="dark">
<head>
<meta charset="UTF-8">
<title>XRP Live Order Book • Global Depth + ETFs</title>
<script src="https://unpkg.com/lightweight-charts@4.1.3/dist/lightweight-charts.standalone.production.js"></script>
<script src="https://cdn.tailwindcss.com"></script>
<script>tailwind.config={darkMode:'class',theme:{extend:{colors:{primary:'#00A3B9',buy:'#10b981',sell:'#ef4444'}}}}</script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
<style>
  body{font-family:'Inter',sans-serif}.chart-container{height:520px}
  @media(max-width:768px){.chart-container{height:340px}}
</style>
</head>
<body class="bg-gray-50 dark:bg-black text-gray-900 dark:text-gray-100 min-h-screen">

<div class="border-b border-gray-200 dark:border-gray-800">
  <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
    <h1 class="text-3xl font-bold bg-gradient-to-r from-primary to-teal-400 bg-clip-text text-transparent">XRP Live Order Book</h1>
    <button id="theme" class="p-2 rounded bg-gray-200 dark:bg-gray-800">Toggle Light/Dark</button>
  </div>
</div>

<div class="max-w-7xl mx-auto p-4 grid grid-cols-1 lg:grid-cols-3 gap-6">

  <!-- Stats -->
  <div class="lg:col-span-3 grid grid-cols-2 md:grid-cols-4 gap-4">
    <div class="bg-white dark:bg-gray-900 rounded-xl p-5 shadow"><p class="text-sm text-gray-500">Price</p><p id="price" class="text-2xl font-bold">$?.????</p><p id="change">--</p></div>
    <div class="bg-white dark:bg-gray-900 rounded-xl p-5 shadow"><p class="text-sm text-gray-500">24h Volume</p><p id="volume" class="text-xl">--</p></div>
    <div class="bg-white dark:bg-gray-900 rounded-xl p-5 shadow"><p class="text-sm text-gray-500">Bid Depth</p><p id="totalBid" class="text-xl text-buy">--</p></div>
    <div class="bg-white dark:bg-gray-900 rounded-xl p-5 shadow"><p class="text-sm text-gray-500">Ask Depth</p><p id="totalAsk" class="text-xl text-sell">--</p></div>
  </div>

  <!-- HISTOGRAM DEPTH CHART -->
  <div class="lg:col-span-2 bg-white dark:bg-gray-900 rounded-2xl shadow-lg overflow-hidden">
    <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-800">
      <h2 class="text-lg font-bold">Global Depth Chart (Histogram)</h2>
    </div>
    <div id="chart" class="chart-container"></div>
  </div>

  <!-- Order Book -->
  <div class="bg-white dark:bg-gray-900 rounded-2xl shadow-lg overflow-hidden">
    <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-800"><h2 class="text-lg font-bold">Live Order Book</h2></div>
    <div class="overflow-x-auto max-h-96">
      <table class="w-full text-sm"><thead class="sticky top-0 bg-gray-50 dark:bg-gray-800">
        <tr><th class="text-left p-3 text-buy">Total</th><th class="text-right p-3 text-buy">Size</th><th class="text-right p-3 text-buy font-bold">Bid</th>
            <th class="px-4">│</th><th class="text-left p-3 text-sell font-bold">Ask</th><th class="text-right p-3 text-sell">Size</th><th class="text-right p-3 text-sell">Total</th></tr>
      </thead><tbody id="bookBody"></tbody></table>
    </div>
  </div>

  <!-- Live Trades -->
  <div class="lg:col-span-2 bg-white dark:bg-gray-900 rounded-2xl shadow-lg overflow-hidden">
    <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-800"><h2 class="text-lg font-bold">Live Trades</h2></div>
    <div id="trades" class="h-64 overflow-y-auto font-mono text-sm px-4"></div>
  </div>

  <!-- ETFs + Holdings -->
  <div class="bg-white dark:bg-gray-900 rounded-2xl shadow-lg overflow-hidden">
    <div class="px-6 py-4 border-b"><h2 class="text-lg font-bold">XRP ETFs – Holdings (Nov 30 2025)</h2></div>
    <div class="overflow-x-auto"><table class="w-full text-sm" id="etfTable"></table></div>
  </div>
</div>

<script>
// Theme
document.getElementById('theme').onclick=()=>document.documentElement.classList.toggle('dark');

// Chart
const chart = LightweightCharts.createChart(document.getElementById('chart'),{
  layout:{background:{color:'#ffffff'},textColor:'#333'},
  grid:{vertLines:{color:'#f0f0f0'},horzLines:{color:'#f0f0f0'}},
  timeScale:{visible:false}, rightPriceScale:{visible:false}, leftPriceScale:{visible:false},
  width:document.getElementById('chart').clientWidth, height:520
});
const bidHist = chart.addHistogramSeries({color:'#10b981'});
const askHist = chart.addHistogramSeries({color:'#ef4444'});

let price = 2.4235;

function updateDepthHistogram(){
  const levels=30;
  const dataBid=[], dataAsk=[];
  let cumBid=0, cumAsk=0;
  for(let i=0;i<levels;i++){
    const bp = price*(1 - i*0.0008 - Math.random()*0.0004);
    const ap = price*(1 + i*0.0008 + Math.random()*0.0004);
    const sz = 1500000 + Math.random()*3000000;
    cumBid+=sz; cumAsk+=sz;
    dataBid.push({time:`b${i}`,value:cumBid});
    dataAsk.push({time:`a${i}`,value:cumAsk});
  }
  bidHist.setData(dataBid.reverse());
  askHist.setData(dataAsk);
}
updateDepthHistogram();

// Price from CoinGecko
async function getPrice(){
  try{
    const r=await fetch('https://api.coingecko.com/api/v3/simple/price?ids=ripple&vs_currencies=usd&include_24hr_change=true&include_24hr_vol=true');
    const j=await r.json();
    price=j.ripple.usd;
    document.getElementById('price').textContent='$'+price.toFixed(4);
    document.getElementById('change').textContent=j.ripple.usd_24h_change.toFixed(2)+'%';
    document.getElementById('change').className=j.ripple.usd_24h_change>=0?'text-buy':'text-sell';
    document.getElementById('volume').textContent='$'+(j.ripple.usd_24h_vol/1e9).toFixed(2)+'B';
  }catch(e){}
}
getPrice(); setInterval(getPrice,7000);

// Order book + trades
function updateBook(){
  const tbody=document.getElementById('bookBody'); tbody.innerHTML='';
  for(let i=0;i<18;i++){
    const bPrice=(price*(1-i*0.0007-Math.random()*0.0002)).toFixed(4);
    const aPrice=(price*(1+i*0.0007+Math.random()*0.0002)).toFixed(4);
    const size=(Math.random()*800+200).toFixed(1);
    const row=`<tr>
      <td class="p-3 text-buy">${(i*1200000/1e6).toFixed(2)}M</td>
      <td class="p-3 text-right text-buy">${size}</td>
      <td class="p-3 text-right text-buy font-bold">${bPrice}</td>
      <td class="text-center text-gray-400">│</td>
      <td class="p-3 text-left text-sell font-bold">${aPrice}</td>
      <td class="p-3 text-right text-sell">${size}</td>
      <td class="p-3 text-right text-sell">${(i*1200000/1e6).toFixed(2)}M</td>
    </tr>`;
    tbody.innerHTML+=row;
  }
}
updateBook(); setInterval(updateBook,12000);

// Trades
setInterval(()=>{
  const buy=Math.random()>0.5;
  const div=document.createElement('div');
  div.className=`py-1 ${buy?'text-buy':'text-sell'}`;
  div.textContent=`${new Date().toLocaleTimeString()}   ${(Math.random()*90+10).toFixed(1)} XRP   $${(price*(1+(Math.random()-0.5)*0.002)).toFixed(4)}`;
  document.getElementById('trades').prepend(div);
},3000);

// ETF Holdings Table
const etfs=[
  {name:"21Shares AXRP", orig:285, sold:34, remain:251},
  {name:"Bitwise XRPT", orig:410, sold:62, remain:348},
  {name:"ProShares PXR", orig:156, sold:19, remain:137},
  {name:"Grayscale GXRP", orig:620, sold:98, remain:522},
  {name:"Canary CXRP", orig:98, sold:11, remain:87}
];
let table='<thead class="bg-gray-100 dark:bg-gray-800"><tr><th class="p-3 text-left">ETF</th><th class="p-3 text-right">Original</th><th class="p-3 text-right text-sell">Sold</th><th class="p-3 text-right text-buy">Remaining</th><th class="p-3 text-right">% Sold</th></tr></thead><tbody>';
etfs.forEach(e=>{
  table+=`<tr><td class="p-3">${e.name}</td><td class="p-3 text-right">${e.orig}M</td><td class="p-3 text-right text-sell">${e.sold}M</td><td class="p-3 text-right text-buy">${e.remain}M</td><td class="p-3 text-right">${(e.sold/e.orig*100).toFixed(1)}%</td></tr>`;
});
table+='</tbody>';
document.getElementById('etfTable').innerHTML=table;

// Refresh chart on resize
window.addEventListener('resize',()=>{chart.applyOptions({width:document.getElementById('chart').clientWidth});});

// Periodic depth refresh
setInterval(()=>{updateDepthHistogram(); updateBook();},10000);
</script>
</body>
</html>
